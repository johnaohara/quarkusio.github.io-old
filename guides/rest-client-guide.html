<!DOCTYPE html>
<html>

<head>
  <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NJWS5L');</script>
  <!-- End Google Tag Manager -->


</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="content">
    <div class="navigation-wrapper">
  <div class="width-12-12">
    <div class="header navigation">
      <div class="logo-wrapper">
        <a class="styled-logo" href="/">Quarkus</a>
      </div>
      <div class="nav-container">
        <nav>
          <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
          <ul class="nav-list">
            <li>
              <a href="/get-started/" class="">Get Started</a>
            </li>
            <li>
              <a href="/guides/" class="active">Guides</a>
            </li>
            <li>
              <a href="/extensions/" class="">Extensions</a>
            </li>
            <li>
              <a href="/community/" class="">Community</a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

    <div class="grid-wrapper guides">
  <div class="grid__item width-12-12">
    <h1 class="text-caps">Quarkus - Using the REST Client</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide explains how to use the MicroProfile REST Client in order to interact with REST APIs
with very little effort.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>less than 15 minutes</p>
</li>
<li>
<p>an IDE</p>
</li>
<li>
<p>JDK 1.8+ installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>Apache Maven 3.5.3+</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Remember, you need to configure Maven as indicated in the <a href="maven-config.html">Maven configuration page</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solution">Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We recommend that you follow the instructions in the next sections and create the application step by step.
However, you can go right to the completed example.</p>
</div>
<div class="paragraph">
<p>Clone the Git repository: <code>git clone <a href="https://github.com/jbossas/protean-quickstarts.git" class="bare">https://github.com/jbossas/protean-quickstarts.git</a></code>, or download an <a href="https://github.com/jbossas/protean-quickstarts/archive/master.zip">archive</a>.</p>
</div>
<div class="paragraph">
<p>The solution is located in the <code>rest-client</code> directory.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-maven-project">Creating the Maven project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we need a new project. Create a new project with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn io.quarkus:quarkus-maven-plugin:1.0.0.Alpha1-SNAPSHOT:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=rest-client \
    -DclassName="org.acme.restclient.CountriesResource" \
    -Dpath="/country" \
    -Dextensions="smallrye-rest-client, resteasy-jsonb"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command generates the Maven project with a REST endpoint and imports the <code>smallrye-rest-client</code> and <code>resteasy-jsonb</code> extensions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-the-model">Setting up the model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide we will be demonstrating how to consume part of the REST API supplied by the <a href="https://restcountries.eu">restcountries.eu</a> service.
Our first order of business is to setup the model we will be using, in the form of a <code>Country</code> POJO.</p>
</div>
<div class="paragraph">
<p>Create a <code>src/main/java/org/acme/restclient/Country.java</code> file and set the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.restclient;

import java.util.List;

public class Country {

    private String name;
    private String alpha2Code;
    private String capital;
    private List&lt;Currency&gt; currencies;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getAlpha2Code() {
        return alpha2Code;
    }

    public void setAlpha2Code(String alpha2Code) {
        this.alpha2Code = alpha2Code;
    }

    public String getCapital() {
        return capital;
    }

    public void setCapital(String capital) {
        this.capital = capital;
    }

    public List&lt;Currency&gt; getCurrencies() {
        return currencies;
    }

    public void setCurrencies(List&lt;Currency&gt; currencies) {
        this.currencies = currencies;
    }

    public static class Currency {
        private String code;
        private String name;
        private String symbol;

        public String getCode() {
            return code;
        }

        public void setCode(String code) {
            this.code = code;
        }

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }

        public String getSymbol() {
            return symbol;
        }

        public void setSymbol(String symbol) {
            this.symbol = symbol;
        }
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The model above in only a subset of the fields provided by the service, but it suffices for the purposes of this guide.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-the-interface">Create the interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using the MicroProfile REST Client is as simple as creating an interface using the proper JAX-RS and MicroProfile annotations. In our case the interface should be created at <code>src/main/java/org/acme/restclient/CountriesService.java</code> and have the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.restclient;

import org.eclipse.microprofile.rest.client.inject.RegisterRestClient;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import java.util.Set;

@Path("/v2")
@RegisterRestClient
public interface CountriesService {

    @GET
    @Path("/name/{name}")
    @Produces("application/json")
    Set&lt;Country&gt; getByName(@PathParam("name") String name);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>getByName</code> method gives our code the ability to query a country by name from the REST Countries API. The client will handle all the networking and marshalling leaving our code clean of such technical details.</p>
</div>
<div class="paragraph">
<p>The purpose of the annotations in the code above is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@RegisterRestClient</code> allows Quarkus to know that this interface is meant to be used as a REST Client</p>
</li>
<li>
<p><code>@Path</code>, <code>@GET</code> and <code>@PathParam</code> are the standard JAX-RS annotations used to define how to access the service</p>
</li>
<li>
<p><code>@Produces</code> defines the expected content-type</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>While <code>@Consumes</code> and <code>@Produces</code> are optional as auto-negotiation is supported,
it is heavily recommended to annotate your endpoints with them to define precisely the expected content-types.</p>
</div>
<div class="paragraph">
<p>It will allow to narrow down the number of JAX-RS providers (which can be seen as converters) included in the native image.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-the-configuration">Create the configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to determine the base URL to which REST calls will be made, the REST Client uses configuration from <code>META-INF/microprofile-config.properties</code>.
The name of the property needs to follow a certain convention which is best displayed in the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># Your configuration properties
org.acme.restclient.CountriesService/mp-rest/url=https://restcountries.eu/rest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having this configuration means that all requests performed using <code>org.acme.restclient.CountriesService</code> will use <code><a href="https://restcountries.eu/rest" class="bare">https://restcountries.eu/rest</a></code> as the base URL.</p>
</div>
<div class="paragraph">
<p>Note that <code>org.acme.restclient.CountriesService</code> <em>must</em> match the fully qualified name of the <code>CountriesService</code> interface we created in the previous section.</p>
</div>
<div class="paragraph">
<p>Using the configuration above, calling the <code>getByName</code> method of <code>CountriesService</code> with a value of <code>France</code> would result in an HTTP GET request being made to <code><a href="https://restcountries.eu/rest/v2/name/France" class="bare">https://restcountries.eu/rest/v2/name/France</a></code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="update-the-jax-rs-resource">Update the JAX-RS resource</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open the <code>src/main/java/org/acme/restclient/CountriesResource.java</code> file and update it with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.eclipse.microprofile.rest.client.inject.RestClient;

import javax.inject.Inject;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import java.util.Set;

@Path("/country")
public class CountriesResource {

    @Inject
    @RestClient
    CountriesService countriesService;


    @GET
    @Path("/name/{name}")
    @Produces(MediaType.APPLICATION_JSON)
    public Set&lt;Country&gt; name(@PathParam("name") String name) {
        return countriesService.getByName(name);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in addition to the standard CDI <code>@Inject</code> annotation, we also need to use the MicroProfile <code>@RestClient</code> annotation to inject <code>CountriesService</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="update-the-test">Update the test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We also need to update the functional test to reflect the changes made to the endpoint.
Edit the <code>src/test/java/org/acme/restclient/CountriesResourceTest.java</code> file and change the content of the <code>testCountryNameEndpoint</code> method to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.restclient;

import io.quarkus.test.junit.QuarkusTest;
import org.junit.jupiter.api.Test;

import static io.restassured.RestAssured.given;
import static org.hamcrest.CoreMatchers.is;

@QuarkusTest
public class CountriesResourceTest {

    @Test
    public void testCountryNameEndpoint() {
        given()
          .when().get("/country/name/greece")
          .then()
             .statusCode(200)
             .body("$.size()", is(1),
                     "[0].alpha2Code", is("GR"),
                     "[0].capital", is("Athens"),
                     "[0].currencies.size()", is(1),
                     "[0].currencies[0].name", is("Euro")
             );
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above uses <a href="http://rest-assured.io/">REST Assured</a>'s <a href="https://github.com/rest-assured/rest-assured/wiki/GettingStarted#jsonpath">json-path</a> capabilities.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="package-and-run-the-application">Package and run the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Run the application with: <code>mvn compile quarkus:dev</code>.
Open your browser to <a href="http://localhost:8080/country/name/greece" class="bare">http://localhost:8080/country/name/greece</a>.</p>
</div>
<div class="paragraph">
<p>You should see a JSON object containing some basic information about Greece.</p>
</div>
<div class="paragraph">
<p>As usual, the application can be packaged using <code>mvn clean package</code> and executed using the <code>-runner.jar</code> file.
You can also generate the native executable with <code>mvn clean package -Pnative</code>.</p>
</div>
</div>
</div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/" class="styled-logo">Quarkus</a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="/">Home</a></li>
          
            <li><a href="/guides">Guides</a></li>
          
            <li><a href="/get-started">Get Started</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Contribute</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://twitter.com/quarkusio">Follow us</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://quarkusio.zulipchat.com">Chatroom</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-6-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse Microprofile</a></li>
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="http://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
        </ul>
      </div>
    
  </div>
</div>
  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a>
    </span>
    <span class="redhat">
      a Red Hat sponsored project   
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/RHLogo_white.svg"></a>
    </span>
  </div>
</div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript">
    if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
        _satellite.pageBottom();
    }
  </script>
</body>

</html>
